<!-- Favicon -->
<link rel="shortcut icon" type="image/x-icon" href="/assetsAdmin/imgs/theme/favicon.svg">
<!-- Template CSS -->
<link href="/assetsAdmin/css/main.css" rel="stylesheet" type="text/css" />

<main class="main">
    <div class="page-header breadcrumb-wrap">
        <div class="container">
            <div class="breadcrumb">
                <a href="index.html" rel="nofollow">Home</a>
                <span></span> <a href="/profile" rel="nofollow">Profile</a>
                <span></span> Edit Address
            </div>
        </div>
    </div>
    <div>

        <section class="content-main col-md-11">
            <div class="content-header">
                <h2 class="content-title">Profile setting </h2>
            </div>
            <div class="card">
                <div class="card-body">
                    <div class="row gx-5">
                        <aside class="col-lg-3 border-end">
                            <nav class="nav nav-pills flex-lg-column mb-4">
                                <a class="nav-link" aria-current="page" href="/profile">General</a>
                                <a class="nav-link" href="/my_orders">Orders</a>
                                <a class="nav-link" href="/wallet">Wallet</a>
                                <a class="nav-link" href="/addresses">My Address</a>
                                <a class="nav-link" href="/logout">Log out</a>
                            </nav>
                        </aside>
                        <div class="col-lg-9">
                            <section class="content-body p-xl-4">
                                <form method="post" action="/edit_address/{{address._id}}">
                                    <div class="row">
                                        <div class="col-lg-8">
                                            <div class="row gx-3">
                                                <div class="col-12 mb-3">
                                                    <label class="form-label">Name</label>
                                                    <input class="form-control" type="text"
                                                        placeholder="Enter your name" name="name" id="name"
                                                        onchange="validateusername()" value="{{address.name}}" required>
                                                </div>
                                                <div class="col-lg-12 mb-3">
                                                    <label class="form-label">Phone</label>
                                                    <input class="form-control" type="tel"
                                                        placeholder="Enter your phone number" name="mobile" id="mobile"
                                                        onchange="validatePhoneNumber()" value="{{address.mobile}}"
                                                        required>
                                                </div>
                                                <div class="col-lg-12 mb-3">
                                                    <label class="form-label">Address line 1</label>
                                                    <input class="form-control" type="text"
                                                        placeholder="Enter your address" name="address1" id="address1"
                                                        onchange="validateAddress()" value="{{address.addressLine1}}"
                                                        required>
                                                </div>
                                                <div class="col-lg-12 mb-3">
                                                    <label class="form-label">Address line 2</label>
                                                    <input class="form-control" type="text"
                                                        placeholder="Enter your address" name="address2" id="address2"
                                                        value="{{address.addressLine2}}" required>
                                                </div>
                                                <div class="col-lg-12 mb-3">
                                                    <label class="form-label">City</label>
                                                    <input class="form-control" type="text"
                                                        placeholder="Enter your City" name="city" id="city"
                                                        onchange="validateCity()" value="{{address.city}}" required>
                                                </div>
                                                <div class="col-lg-12 mb-3">
                                                    <label class="form-label">State</label>
                                                    <input class="form-control" type="text"
                                                        placeholder="Enter your State" name="state" id="state"
                                                        value="{{address.state}}" required>
                                                </div>
                                                <div class="col-lg-12 mb-3">
                                                    <label class="form-label">Pincode</label>
                                                    <input class="form-control" type="tel"
                                                        placeholder="Enter your Pincode" name="pin" id="pin"
                                                        onchange="validatePin()" value="{{address.pin}}" required>
                                                </div>

                                            </div> <!-- row.// -->
                                        </div> <!-- col.// -->
                                        


                                    </div> <!-- row.// -->
                                    <br>
                                    <button class="btn btn-primary" type="submit">Save Address</button>
                                    <a type="button" id="backbutton" class="btn btn-primary">Back</a>
                                </form>
                                
                            </section> <!-- content-body .// -->
                        </div> <!-- col.// -->
                    </div> <!-- row.// -->
                </div> <!-- card body end// -->
            </div> <!-- card end// -->
        </section> <!-- content-main end// -->

    </div>
</main>


<!-- Main Script -->
<script src="/assetsAdmin/js/main.js" type="text/javascript"></script>
{{!-- sweetalert --}}

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<script>
    function previewImage(input) {
        if (input.files && input.files[0]) {
            const reader = new FileReader();

            reader.onload = function (e) {
                document.getElementById('userPhoto').src = e.target.result;
            }

            reader.readAsDataURL(input.files[0]); // Read the image as a data URL.
        }
    }

    function validateusername() {
        var username = document.getElementById('name').value;

        var userPattern = /^[a-zA-Z]{3,}$/;

        if (!userPattern.test(username)) {
            alert("Invalid username please try again.");

            document.getElementById('name').value = '';

            document.getElementById('name').focus();
            return false;
        }

        return true;
    }

    function validatePhoneNumber() {
        var phoneNumber = document.getElementById('mobile').value;

        var phonePattern = /^\d{10}$/;

        if (!phonePattern.test(phoneNumber)) {
            alert('Invalid phone number! Please enter a 10-digit number.');

            
            document.getElementById('mobile').value = '';

            
            document.getElementById('mobile').focus();
            return false;
        }

        return true; 
    }


    function validateAddress() {
        var address = document.getElementById('address1').value.trim();
        if (address.length < 3) {
            alert("Invalid address, please try again.");
            document.getElementById('address1').value = '';
            document.getElementById('address1').focus();
            return false;
        }
        return true;
    }


    function validateCity() {
        var city = document.getElementById('city').value.trim();
        var cityPattern = /^[a-zA-Z\s]{3,}$/;
        if (!cityPattern.test(city)) {
            alert("Invalid city, please try again.");
            document.getElementById('city').value = '';
            document.getElementById('city').focus();
            return false;
        }
        return true;
    }

    function validatePin() {
        var pin = document.getElementById('pin').value.trim();

        
        if (pin === '' || isNaN(pin)) {
            alert("Pincode must be a numerical value.");
            document.getElementById('pin').value = '';
            document.getElementById('pin').focus();
            return false;
        }

        
        if (pin.length !== 6) {
            alert("Pincode must have exactly 6 digits.");
            document.getElementById('pin').value = '';
            document.getElementById('pin').focus();
            return false;
        }

        return true;
    }





    //back
    $(document).ready(function () {
        $('#backbutton').click(function (e) {
            e.preventDefault();


            Swal.fire({
                title: "Leave the page?",
                text: "The Data will not be saved",
                icon: "warning",
                showCancelButton: true,
                confirmButtonColor: "#088178",
                cancelButtonColor: "#d33",
                confirmButtonText: "Yes"
            }).then((result) => {
                if (result.isConfirmed) {
                    window.location.href = "/addresses";

                }
            });


        });
    }
    )

</script>